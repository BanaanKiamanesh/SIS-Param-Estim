%% MCMC Trajectory Plot
function plot_X_trajectory(X)
    figure;
    hold on;
    title('MCMC Trajectory')

    % Plot Trajectory
    plot(X(1, :), X(end, :), 'o--', X(1,1), X(end,1), 'r*')

    % Draw Ellipses representing
    x = X(1, :)';
    y = X(end, :)';
    data = [x, y];

    mu = mean(data);
    Sigma = cov(data);

    plot_gaussian_ellipse(mu, Sigma, 1, 'g');
    plot_gaussian_ellipse(mu, Sigma, 2, 'y');
    plot_gaussian_ellipse(mu, Sigma, 3, 'r');

    plot(mu(1), mu(2), 'rx', 'MarkerSize', 10);
end

function plot_gaussian_ellipse(mu, Sigma, nsig, color)
    theta = linspace(0, 2*pi, 100);
    circle = [cos(theta); sin(theta)];
    [V, D] = eig(Sigma);
    ellipse = nsig * V * sqrt(D) * circle;
    ellipse = ellipse + mu';
    plot(ellipse(1,:), ellipse(2,:), color, 'LineWidth', 0.5);
end